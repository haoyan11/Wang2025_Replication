# ä»Šæ—¥ä¿®æ”¹æ€»ç»“ (2025-12-24)

**ä¿®æ”¹æ—¶é—´èŒƒå›´**: 12:00 - 13:45
**ä¸»è¦å·¥ä½œ**: åˆ›å»ºæ–°åˆ†è§£æ–¹æ³•ï¼ˆTiming/Shapeï¼‰ã€å®Œå–„Tç‰©å€™ç‰ˆæœ¬ã€æ–‡æ¡£æ•´ç†

---

## ğŸ“Š ä¿®æ”¹æ¦‚è§ˆ

### ä¸€ã€æ–°å¢æ–‡ä»¶ (4ä¸ª)

#### 1. **03_decomposition_timing_shape.py** â­ æ ¸å¿ƒæ–°å¢
**åˆ›å»ºæ—¶é—´**: 13:37
**æ–‡ä»¶å¤§å°**: 7.2KB
**åŠŸèƒ½**: å®ç°æ–°çš„TRcåˆ†è§£æ–¹æ³•ï¼ˆTiming/Shapeåˆ†è§£ï¼‰

**åˆ†è§£å…¬å¼**:
```
TRc_y - TRc_av = Î”TR_timing + Î”TR_shape

å…¶ä¸­:
- TRc_y   = Î£[t=SOS_y..POS_y] B_y(t)  (å½“å¹´çª—å£å†…çš„å®é™…TR)
- TRc_av  = Î£[t=SOSav..POSav] A(t)    (æ°”å€™æ€çª—å£å†…çš„æ°”å€™æ€TR)
- Î”TR_timing = Î£[t=SOS_y..POS_y] A(t) - TRc_av  (ç‰©å€™çª—å£å˜åŒ–è´¡çŒ®)
- Î”TR_shape  = Î£[t=SOS_y..POS_y] (B_y(t) - A(t)) (TRæ—¥å˜åŒ–è´¡çŒ®)
```

**è¿›ä¸€æ­¥æ‹†åˆ†**:
```
Î”TR_timing = Î”TR_SOS + Î”TR_POS
- Î”TR_SOS = Î£[t=SOS_y..POSav] A(t) - TRc_av  (SOSå˜åŒ–è´¡çŒ®)
- Î”TR_POS = Î£[t=SOS_y..POS_y] A(t) - Î£[t=SOS_y..POSav] A(t)  (POSå˜åŒ–è´¡çŒ®)
```

**è¾“å‡ºæ–‡ä»¶** (37å¹´ Ã— 4å˜é‡ = 148ä¸ªæ–‡ä»¶):
```
Wang2025_Analysis/Decomposition_TimingShape/
â”œâ”€â”€ TRc_av.tif
â”œâ”€â”€ TRtiming_1982.tif ... TRtiming_2018.tif
â”œâ”€â”€ TRshape_1982.tif  ... TRshape_2018.tif
â”œâ”€â”€ TRsos_1982.tif    ... TRsos_2018.tif
â””â”€â”€ TRpos_1982.tif    ... TRpos_2018.tif
```

**ä¸åŸåˆ†è§£æ–¹æ³•çš„åŒºåˆ«**:
| é¡¹ç›® | åŸæ–¹æ³• (03_decomposition_original.py) | æ–°æ–¹æ³• (Timing/Shape) |
|------|--------------------------------------|---------------------|
| **åˆ†è§£å¯¹è±¡** | TRc = TRc_av + TRpheno + TRproduct | TRc - TRc_av = TRtiming + TRshape |
| **TRc_avå®šä¹‰** | Î£[SOSav:POSav] A(t) | åŒå·¦ |
| **ç‰©å€™è´¡çŒ®** | TRpheno = Â±Î£[SOS_yåˆ°SOSavä¹‹é—´] A(t) | TRtiming = Î£[SOS_y:POS_y] A(t) - TRc_av |
| **å…¶ä»–è´¡çŒ®** | TRproduct = TRc - TRc_av - TRpheno | TRshape = TRc - Î£[SOS_y:POS_y] A(t) |
| **ç‰©ç†æ„ä¹‰** | ç‰©å€™çª—å£ç§»åŠ¨ vs ç”Ÿäº§åŠ›å¼‚å¸¸ | çª—å£æ—¶é—´ vs çª—å£å†…å¼ºåº¦ |
| **è¾“å‡ºå˜é‡** | 2ä¸ª (TRpheno, TRproduct) | 4ä¸ª (TRtiming, TRshape, TRsos, TRpos) |

---

#### 2. **05_statistical_analysis_timing_shape.py** â­ æ ¸å¿ƒæ–°å¢
**åˆ›å»ºæ—¶é—´**: 13:45
**æ–‡ä»¶å¤§å°**: 8.4KB
**åŠŸèƒ½**: å¯¹Timing/Shapeåˆ†è§£ç»“æœè¿›è¡ŒÎ”SOSå›å½’åˆ†æ

**åˆ†æå†…å®¹**:
```python
å“åº”å˜é‡ ~ Î”SOS çš„åƒå…ƒçº§çº¿æ€§å›å½’:
- TRshape  ~ Î”SOS
- TRtiming ~ Î”SOS
- TRsos    ~ Î”SOS
- TRpos    ~ Î”SOS
- Trate    ~ Î”SOS  (Trate = TRc / GLS)
```

**è¾“å‡ºæ–‡ä»¶** (5å˜é‡ Ã— 3æŒ‡æ ‡ = 15ä¸ªæ–‡ä»¶):
```
Wang2025_Analysis/Statistical_Analysis_TimingShape/Section_3.2_Phenology_Impact/
â”œâ”€â”€ TRshape_vs_deltaSOS_slope.tif
â”œâ”€â”€ TRshape_vs_deltaSOS_pvalue.tif
â”œâ”€â”€ TRshape_vs_deltaSOS_R2.tif
â”œâ”€â”€ TRtiming_vs_deltaSOS_slope.tif
â”œâ”€â”€ TRtiming_vs_deltaSOS_pvalue.tif
â”œâ”€â”€ TRtiming_vs_deltaSOS_R2.tif
â”œâ”€â”€ TRsos_vs_deltaSOS_slope.tif
â”œâ”€â”€ TRsos_vs_deltaSOS_pvalue.tif
â”œâ”€â”€ TRsos_vs_deltaSOS_R2.tif
â”œâ”€â”€ TRpos_vs_deltaSOS_slope.tif
â”œâ”€â”€ TRpos_vs_deltaSOS_pvalue.tif
â”œâ”€â”€ TRpos_vs_deltaSOS_R2.tif
â”œâ”€â”€ Trate_vs_deltaSOS_slope.tif
â”œâ”€â”€ Trate_vs_deltaSOS_pvalue.tif
â””â”€â”€ Trate_vs_deltaSOS_R2.tif
```

**å…³é”®ç‰¹æ€§**:
- ä½¿ç”¨æ ‡å‡†Î”SOSå®šä¹‰ (SOS_year - SOSav, advance < 0)
- p<0.05æ˜¾è‘—æ€§æ£€éªŒ
- æœ€å°æœ‰æ•ˆå¹´ä»½è¦æ±‚: 60%

---

#### 3. **02_TRc_calculation_T.py**
**åˆ›å»ºæ—¶é—´**: 12:49
**æ–‡ä»¶å¤§å°**: 28.6KB
**åŠŸèƒ½**: ä½¿ç”¨Tç‰©å€™ï¼ˆTemperature phenologyï¼‰è®¡ç®—TRcçš„ç‰ˆæœ¬

**ä¿®æ”¹å†…å®¹**:
```python
# ç‰©å€™æ•°æ®æº
PHENO_DIR = "T_phenology"  # GPP_phenology â†’ T_phenology

# è¾“å‡ºè·¯å¾„
OUTPUT_DIR = "TRc_annual_T"        # TRc_annual â†’ TRc_annual_T
climatology_dir = "Climatology_T"  # Climatology â†’ Climatology_T

# æ–‡ä»¶å
"sos_gpp_" â†’ "sos_t_"
"pos_doy_gpp_" â†’ "pos_doy_t_"
```

**ä¿æŒä¸å˜**: æ‰€æœ‰è®¡ç®—é€»è¾‘ã€NODATAå¤„ç†ã€ä¼˜åŒ–ç‰¹æ€§å®Œå…¨ç›¸åŒ

---

#### 4. **03_decomposition_original_T.py**
**åˆ›å»ºæ—¶é—´**: 12:49
**æ–‡ä»¶å¤§å°**: 13.8KB
**åŠŸèƒ½**: ä½¿ç”¨Tç‰©å€™è¿›è¡ŒåŸå§‹åˆ†è§£æ–¹æ³•çš„ç‰ˆæœ¬

**ä¿®æ”¹å†…å®¹**:
```python
# è¾“å…¥è·¯å¾„
PHENO_DIR = "T_phenology"
TRC_DIR = "TRc_annual_T"
CLIMATOLOGY_DIR = "Climatology_T"

# è¾“å‡ºè·¯å¾„
OUTPUT_DIR = "Decomposition_T"

# æ–‡ä»¶å
"sos_gpp_" â†’ "sos_t_"
```

**ä¿æŒä¸å˜**: åˆ†è§£ç®—æ³•ã€Wang 2025æ–¹æ³•å®ç°

---

### äºŒã€ä¿®æ”¹æ–‡ä»¶ (3ä¸ª)

#### 1. **05_statistical_analysis_T.py**
**ä¿®æ”¹æ—¶é—´**: 13:20
**ä¸»è¦ä¿®æ”¹**: æ·»åŠ Trateå˜é‡çš„Î”SOSå›å½’åˆ†æ

**æ–°å¢å†…å®¹**:
```python
# Line 744-767: æ·»åŠ Trateè®¡ç®—
response_vars = ['TRc', 'TRpheno', 'TRproduct', 'Trate']  # â† æ–°å¢Trate

# è®¡ç®— Trate = TRc / GLS
gls_stack = pos_stack - sos_stack + 1  # GLS = POS - SOS + 1
trate_stack = trc_stack / gls_stack
response_data['Trate'] = trate_stack
```

**è¾“å‡ºæ–°å¢**:
```
Statistical_Analysis_T/Section_3.2_Phenology_Impact/
â”œâ”€â”€ Trate_vs_deltaSOS_slope.tif   â† æ–°å¢
â”œâ”€â”€ Trate_vs_deltaSOS_pvalue.tif  â† æ–°å¢
â””â”€â”€ Trate_vs_deltaSOS_R2.tif      â† æ–°å¢
```

---

#### 2. **05_statistical_analysis.py**
**ä¿®æ”¹æ—¶é—´**: 13:13
**ä¸»è¦ä¿®æ”¹**: ä¸05_statistical_analysis_T.pyç›¸åŒï¼Œæ·»åŠ Trateåˆ†æ

**å½±å“**: GPPç‰©å€™ç‰ˆæœ¬ä¹Ÿèƒ½åˆ†æTrate vs Î”SOSå…³ç³»

---

#### 3. **03_decomposition_original.py**
**ä¿®æ”¹æ—¶é—´**: 13:06
**ä¸»è¦ä¿®æ”¹**: ä»£ç ä¼˜åŒ–å’Œæ³¨é‡Šå®Œå–„

**å…·ä½“ä¿®æ”¹**:
```python
# Line 44-56: æ›´æ–°_is_valid_valueå‡½æ•°ï¼ˆå®Œå–„NODATAåˆ¤æ–­ï¼‰
# Line 58-75: æ›´æ–°read_geotiff/write_geotiffå‡½æ•°ï¼ˆç»Ÿä¸€è¿”å›æ ¼å¼ï¼‰
# Line 97-169: æ›´æ–°load_climatology_dataå‡½æ•°ï¼ˆæ›´è¯¦ç»†çš„æ³¨é‡Šï¼‰
# Line 171-233: æ›´æ–°calculate_TRc_av_from_climatologyå‡½æ•°ï¼ˆæ³¨é‡Šä¼˜åŒ–ï¼‰
# Line 235-315: æ›´æ–°decompose_TRc_originalå‡½æ•°ï¼ˆæ³¨é‡Šä¼˜åŒ–ï¼‰
```

**ä¼˜åŒ–ç›®çš„**: æé«˜ä»£ç å¯è¯»æ€§å’Œç»´æŠ¤æ€§ï¼Œä¸å…¶ä»–æ¨¡å—ä¿æŒä¸€è‡´çš„ä»£ç é£æ ¼

---

### ä¸‰ã€æ–‡æ¡£æ›´æ–° (2ä¸ª)

#### 1. **æ£€æŸ¥ç»Ÿè®¡ç»“æœå·®å¼‚.md**
**ä¿®æ”¹æ—¶é—´**: 12:20
**å†…å®¹**: GPPç‰©å€™ vs è®ºæ–‡ç»“æœå·®å¼‚è¯Šæ–­ï¼ˆä»ä¹‹å‰çš„ä¼šè¯ç»§æ‰¿ï¼‰

**ä¸»è¦å†…å®¹**:
- å›å½’ç»“æœå¯¹æ¯” (TRc: -1.515, TRpheno: -0.432, TRproduct: -1.139)
- å¯èƒ½åŸå› åˆ†æ (TRcå•ä½ã€æ©è†œèŒƒå›´ã€ç»Ÿè®¡æ–¹æ³•ç­‰)
- è°ƒè¯•æ­¥éª¤å»ºè®®

---

#### 2. **dSOSç¬¦å·ä¿®æ­£è¯´æ˜.md**
**ä¿®æ”¹æ—¶é—´**: 12:11
**å†…å®¹**: Î”SOSå®šä¹‰ä¿®æ­£è®°å½•ï¼ˆä»ä¹‹å‰çš„ä¼šè¯ç»§æ‰¿ï¼‰

**ä¿®æ­£å†…å®¹**:
- åŸå®šä¹‰: dSOS = SOSav - SOS_year (éæ ‡å‡†ï¼Œæå‰>0)
- æ–°å®šä¹‰: Î”SOS = SOS_year - SOSav (æ ‡å‡†å¼‚å¸¸ï¼Œæå‰<0)
- æ‰€æœ‰ç›¸å…³æ–‡ä»¶å·²ä¿®æ­£ï¼ˆ05_statistical_analysis.pyç­‰ï¼‰

---

## ğŸ¯ ä¸‰ç§åˆ†è§£æ–¹æ³•å¯¹æ¯”

### å¯¹æ¯”è¡¨

| ç‰¹æ€§ | åŸå§‹æ–¹æ³• (original) | æ”¹è¿›æ–¹æ³• (improved) | Timing/Shapeæ–¹æ³• |
|------|-------------------|-------------------|-----------------|
| **è„šæœ¬** | 03_decomposition_original.py | 04_decomposition_improved.py | 03_decomposition_timing_shape.py |
| **ç‰©å€™æº** | GPP (sos_gpp) | GPP | GPP |
| **Tç‰©å€™ç‰ˆæœ¬** | âœ… 03_decomposition_original_T.py | âŒ æœªåˆ›å»º | âŒ æœªåˆ›å»º |
| **åˆ†è§£å…¬å¼** | Wang 2025åŸæ–‡ | ä¿®æ­£çš„Wangæ–¹æ³• | å…¨æ–°Timing/Shapeæ–¹æ³• |
| **TRc_av** | Î£[SOSav:POSav] A(t) | åŒå·¦ | åŒå·¦ |
| **ç»„åˆ†1** | TRpheno (ç‰©å€™çª—å£ç§»åŠ¨) | TRpheno_corrected | TRtiming (çª—å£æ—¶é—´å˜åŒ–) |
| **ç»„åˆ†2** | TRproduct (å…¶ä»–) | TRproduct_corrected | TRshape (çª—å£å†…å¼ºåº¦å˜åŒ–) |
| **è¿›ä¸€æ­¥æ‹†åˆ†** | âŒ | âŒ | âœ… TRsos + TRpos |
| **ç»Ÿè®¡åˆ†æ** | âœ… 05_statistical_analysis.py | âŒ æœªå®Œæˆ | âœ… 05_statistical_analysis_timing_shape.py |
| **è¾“å‡ºç›®å½•** | Decomposition / Decomposition_T | Decomposition_Improved | Decomposition_TimingShape |
| **å®Œæˆåº¦** | âœ… å®Œæ•´ | âš ï¸ éƒ¨åˆ† | âœ… å®Œæ•´ |

---

## ğŸ“‚ å½“å‰é¡¹ç›®æ–‡ä»¶ç»“æ„

```
Wang2025_Replication/
â”‚
â”œâ”€â”€ ğŸ“„ æ ¸å¿ƒå¤„ç†è„šæœ¬ (Python)
â”‚   â”œâ”€â”€ 00_data_preparation.py           æ•°æ®å‡†å¤‡ï¼ˆåœŸå£¤æ¹¿åº¦æ ¼å¼è½¬æ¢ç­‰ï¼‰
â”‚   â”œâ”€â”€ 00_master_pipeline.py            ä¸»æµç¨‹ç®¡ç†
â”‚   â”œâ”€â”€ 01_phenology_extraction.py       ç‰©å€™æå–ï¼ˆä»å¤–éƒ¨è„šæœ¬è¯»å–ï¼‰
â”‚   â”œâ”€â”€ 02_TRc_calculation.py            TRcç´¯ç§¯è’¸è…¾è®¡ç®—ï¼ˆGPPç‰©å€™ï¼‰â­
â”‚   â”œâ”€â”€ 02_TRc_calculation_T.py          TRcç´¯ç§¯è’¸è…¾è®¡ç®—ï¼ˆTç‰©å€™ï¼‰â­ ä»Šæ—¥æ–°å¢
â”‚   â”œâ”€â”€ 03_decomposition_original.py     åŸå§‹åˆ†è§£ï¼ˆGPPç‰©å€™ï¼ŒWang 2025ï¼‰â­
â”‚   â”œâ”€â”€ 03_decomposition_original_T.py   åŸå§‹åˆ†è§£ï¼ˆTç‰©å€™ï¼‰â­ ä»Šæ—¥æ–°å¢
â”‚   â”œâ”€â”€ 03_decomposition_timing_shape.py Timing/Shapeåˆ†è§£ï¼ˆæ–°æ–¹æ³•ï¼‰â­â­ ä»Šæ—¥æ–°å¢
â”‚   â”œâ”€â”€ 04_decomposition_improved.py     æ”¹è¿›åˆ†è§£ï¼ˆæœªå®Œæˆï¼‰
â”‚   â”œâ”€â”€ 05_statistical_analysis.py       ç»Ÿè®¡åˆ†æï¼ˆGPPç‰©å€™ï¼ŒåŸå§‹åˆ†è§£ï¼‰â­
â”‚   â”œâ”€â”€ 05_statistical_analysis_T.py     ç»Ÿè®¡åˆ†æï¼ˆTç‰©å€™ï¼ŒåŸå§‹åˆ†è§£ï¼‰â­
â”‚   â”œâ”€â”€ 05_statistical_analysis_timing_shape.py  ç»Ÿè®¡åˆ†æï¼ˆTiming/Shapeï¼‰â­â­ ä»Šæ—¥æ–°å¢
â”‚   â”œâ”€â”€ 06_SEM_analysis.R                ç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆRè¯­è¨€ï¼‰
â”‚   â””â”€â”€ 07_plotting_functions.py         ç»˜å›¾å‡½æ•°
â”‚
â”œâ”€â”€ ğŸ› ï¸ å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ config.py                        å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ verify_data.py                   æ•°æ®éªŒè¯
â”‚   â”œâ”€â”€ utils_climatology.py             æ°”å€™æ€è®¡ç®—å·¥å…·
â”‚   â””â”€â”€ utils_vegetation_stratification.py æ¤è¢«åˆ†å±‚å·¥å…·
â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£
â”‚   â”œâ”€â”€ START_HERE.md                    å¿«é€Ÿå¼€å§‹æŒ‡å—
â”‚   â”œâ”€â”€ README.md                        é¡¹ç›®è¯´æ˜
â”‚   â”œâ”€â”€ CHECKLIST.md                     æ£€æŸ¥æ¸…å•
â”‚   â”œâ”€â”€ CHANGELOG.md                     å˜æ›´æ—¥å¿—
â”‚   â”œâ”€â”€ å®Œæˆæ€»ç»“.md                      å®Œæˆæ€»ç»“
â”‚   â”œâ”€â”€ æ•´ç†å®Œæˆ.md                      æ•´ç†å®Œæˆè®°å½•
â”‚   â”œâ”€â”€ æ•°æ®é…ç½®è¯´æ˜.md                  æ•°æ®é…ç½®è¯¦ç»†è¯´æ˜
â”‚   â”œâ”€â”€ TRcè®¡ç®—ä¼˜åŒ–è¯´æ˜.md               TRcè®¡ç®—v1.3.1ä¼˜åŒ–è¯´æ˜
â”‚   â”œâ”€â”€ åœŸå£¤æ°´åˆ†æ ¼å¼ä¿®æ­£è¯´æ˜.md          åœŸå£¤æ¹¿åº¦æ•°æ®ä¿®æ­£è®°å½•
â”‚   â”œâ”€â”€ dSOSç¬¦å·ä¿®æ­£è¯´æ˜.md              Î”SOSç¬¦å·ä¿®æ­£è®°å½•
â”‚   â”œâ”€â”€ æ£€æŸ¥ç»Ÿè®¡ç»“æœå·®å¼‚.md              ç»Ÿè®¡ç»“æœå·®å¼‚è¯Šæ–­
â”‚   â””â”€â”€ ä»Šæ—¥ä¿®æ”¹æ€»ç»“_20251224.md        æœ¬æ–‡æ¡£ â­ ä»Šæ—¥æ–°å¢
â”‚
â”œâ”€â”€ ğŸ“¦ å…¶ä»–
â”‚   â”œâ”€â”€ requirements.txt                 Pythonä¾èµ–
â”‚   â”œâ”€â”€ archive/                         å½’æ¡£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ README.md.original
â”‚   â”‚   â””â”€â”€ QUICKSTART.md.original
â”‚   â”œâ”€â”€ æ–‡ä»¶/                            å‚è€ƒæ–‡çŒ®
â”‚   â”‚   â””â”€â”€ Wang (2025) æ˜¥å­£ç‰©å€™å¯¹æ£®æ—è’¸è…¾...ä¸­æ–‡ç¿»è¯‘.pdf
â”‚   â””â”€â”€ __pycache__/                     Pythonç¼“å­˜
â”‚
â””â”€â”€ .git/                                Gitç‰ˆæœ¬æ§åˆ¶
```

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

### æµç¨‹å›¾

```
æ•°æ®å‡†å¤‡é˜¶æ®µ:
00_data_preparation.py â†’ æ ¼å¼è½¬æ¢ã€æ©è†œåˆ›å»º

ç‰©å€™æå–é˜¶æ®µ:
01_phenology_extraction.py â†’ SOS/POSç‰©å€™æŒ‡æ ‡æå–

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           TRcè®¡ç®—ï¼ˆä¸¤å¥—ç‰©å€™ç³»ç»Ÿï¼‰                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GPPç‰©å€™ç‰ˆ                â”‚  Tç‰©å€™ç‰ˆ              â”‚
â”‚ 02_TRc_calculation.py    â”‚  02_TRc_calculation_T.py â”‚
â”‚ â†“                        â”‚  â†“                    â”‚
â”‚ TRc_annual/              â”‚  TRc_annual_T/        â”‚
â”‚ Climatology/             â”‚  Climatology_T/       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åˆ†è§£æ–¹æ³•ï¼ˆä¸‰ç§ï¼‰                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸå§‹æ–¹æ³•           â”‚ æ”¹è¿›æ–¹æ³• â”‚ Timing/Shapeæ–¹æ³• â”‚
â”‚ (Wang 2025)        â”‚ (ä¿®æ­£)   â”‚ (æ–°æ–¹æ³•)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GPP: 03_decomposition_original.py                â”‚
â”‚ T:   03_decomposition_original_T.py              â”‚
â”‚ â†“                  â”‚ â†“       â”‚ â†“               â”‚
â”‚ Decomposition/     â”‚ Decomp_ â”‚ Decomposition_  â”‚
â”‚ Decomposition_T/   â”‚ Improvedâ”‚ TimingShape/    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ç»Ÿè®¡åˆ†æï¼ˆÎ”SOSå›å½’ï¼‰                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GPPç‰©å€™-åŸå§‹: 05_statistical_analysis.py         â”‚
â”‚ Tç‰©å€™-åŸå§‹:   05_statistical_analysis_T.py       â”‚
â”‚ GPP-Timing/Shape: 05_statistical_analysis_timing_shape.py â”‚
â”‚ â†“                                                â”‚
â”‚ Statistical_Analysis/                            â”‚
â”‚ Statistical_Analysis_T/                          â”‚
â”‚ Statistical_Analysis_TimingShape/                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åç»­åˆ†æ:
06_SEM_analysis.R â†’ ç»“æ„æ–¹ç¨‹æ¨¡å‹
07_plotting_functions.py â†’ å¯è§†åŒ–
```

---

## ğŸ“Š è¾“å‡ºæ•°æ®ç»„ç»‡

### æ•°æ®ç›®å½•æ ‘

```
Wang2025_Analysis/
â”‚
â”œâ”€â”€ masks/                              æ©è†œæ–‡ä»¶
â”‚   â””â”€â”€ combined_mask.tif
â”‚
â”œâ”€â”€ TRc_annual/                         TRcç´¯ç§¯è’¸è…¾ï¼ˆGPPç‰©å€™ï¼‰
â”‚   â”œâ”€â”€ TRc_1982.tif ... TRc_2018.tif  (37ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ (ç”±02_TRc_calculation.pyç”Ÿæˆ)
â”‚
â”œâ”€â”€ TRc_annual_T/                       TRcç´¯ç§¯è’¸è…¾ï¼ˆTç‰©å€™ï¼‰â­ ä»Šæ—¥æ–°å¢
â”‚   â”œâ”€â”€ TRc_1982.tif ... TRc_2018.tif  (37ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ (ç”±02_TRc_calculation_T.pyç”Ÿæˆ)
â”‚
â”œâ”€â”€ Climatology/                        æ°”å€™æ€æ•°æ®ï¼ˆGPPç‰©å€™ï¼‰
â”‚   â”œâ”€â”€ TR_daily_climatology.tif       (365æ³¢æ®µ)
â”‚   â”œâ”€â”€ SOSav.tif
â”‚   â””â”€â”€ POSav.tif
â”‚
â”œâ”€â”€ Climatology_T/                      æ°”å€™æ€æ•°æ®ï¼ˆTç‰©å€™ï¼‰â­
â”‚   â”œâ”€â”€ TR_daily_climatology.tif
â”‚   â”œâ”€â”€ SOSav.tif
â”‚   â””â”€â”€ POSav.tif
â”‚
â”œâ”€â”€ Decomposition/                      åŸå§‹åˆ†è§£ç»“æœï¼ˆGPPç‰©å€™ï¼‰
â”‚   â”œâ”€â”€ TRc_av.tif
â”‚   â”œâ”€â”€ TRpheno_1982.tif ... TRpheno_2018.tif    (37ä¸ª)
â”‚   â””â”€â”€ TRproduct_1982.tif ... TRproduct_2018.tif (37ä¸ª)
â”‚
â”œâ”€â”€ Decomposition_T/                    åŸå§‹åˆ†è§£ç»“æœï¼ˆTç‰©å€™ï¼‰â­
â”‚   â”œâ”€â”€ TRc_av.tif
â”‚   â”œâ”€â”€ TRpheno_1982.tif ... TRpheno_2018.tif
â”‚   â””â”€â”€ TRproduct_1982.tif ... TRproduct_2018.tif
â”‚
â”œâ”€â”€ Decomposition_TimingShape/          Timing/Shapeåˆ†è§£ç»“æœ â­â­ ä»Šæ—¥æ–°å¢
â”‚   â”œâ”€â”€ TRc_av.tif
â”‚   â”œâ”€â”€ TRtiming_1982.tif ... TRtiming_2018.tif  (37ä¸ª)
â”‚   â”œâ”€â”€ TRshape_1982.tif ... TRshape_2018.tif    (37ä¸ª)
â”‚   â”œâ”€â”€ TRsos_1982.tif ... TRsos_2018.tif        (37ä¸ª)
â”‚   â””â”€â”€ TRpos_1982.tif ... TRpos_2018.tif        (37ä¸ª)
â”‚
â”œâ”€â”€ Statistical_Analysis/               ç»Ÿè®¡åˆ†æç»“æœï¼ˆGPPç‰©å€™-åŸå§‹åˆ†è§£ï¼‰
â”‚   â””â”€â”€ Section_3.2_Phenology_Impact/
â”‚       â”œâ”€â”€ TRc_vs_deltaSOS_slope/pvalue/R2.tif
â”‚       â”œâ”€â”€ TRpheno_vs_deltaSOS_slope/pvalue/R2.tif
â”‚       â”œâ”€â”€ TRproduct_vs_deltaSOS_slope/pvalue/R2.tif
â”‚       â””â”€â”€ Trate_vs_deltaSOS_slope/pvalue/R2.tif â­ ä»Šæ—¥æ–°å¢
â”‚
â”œâ”€â”€ Statistical_Analysis_T/             ç»Ÿè®¡åˆ†æç»“æœï¼ˆTç‰©å€™-åŸå§‹åˆ†è§£ï¼‰â­
â”‚   â””â”€â”€ Section_3.2_Phenology_Impact/
â”‚       â”œâ”€â”€ TRc_vs_deltaSOS_*.tif
â”‚       â”œâ”€â”€ TRpheno_vs_deltaSOS_*.tif
â”‚       â”œâ”€â”€ TRproduct_vs_deltaSOS_*.tif
â”‚       â””â”€â”€ Trate_vs_deltaSOS_*.tif
â”‚
â””â”€â”€ Statistical_Analysis_TimingShape/   ç»Ÿè®¡åˆ†æç»“æœï¼ˆTiming/Shapeï¼‰â­â­ ä»Šæ—¥æ–°å¢
    â””â”€â”€ Section_3.2_Phenology_Impact/
        â”œâ”€â”€ TRshape_vs_deltaSOS_slope/pvalue/R2.tif
        â”œâ”€â”€ TRtiming_vs_deltaSOS_slope/pvalue/R2.tif
        â”œâ”€â”€ TRsos_vs_deltaSOS_slope/pvalue/R2.tif
        â”œâ”€â”€ TRpos_vs_deltaSOS_slope/pvalue/R2.tif
        â””â”€â”€ Trate_vs_deltaSOS_slope/pvalue/R2.tif
```

---

## ğŸ¯ ä»Šæ—¥å·¥ä½œé‡ç‚¹æ€»ç»“

### 1. **æ–¹æ³•å­¦åˆ›æ–°** â­â­
- å®ç°äº†å…¨æ–°çš„Timing/Shapeåˆ†è§£æ–¹æ³•
- åŒºåˆ†äº†ç‰©å€™çª—å£å˜åŒ–(timing)å’Œçª—å£å†…å¼ºåº¦å˜åŒ–(shape)
- è¿›ä¸€æ­¥å°†timingæ‹†åˆ†ä¸ºSOSå’ŒPOSçš„ç‹¬ç«‹è´¡çŒ®
- å®Œæ•´çš„ç»Ÿè®¡åˆ†ææµç¨‹ï¼ˆÎ”SOSå›å½’ï¼‰

### 2. **ç‰©å€™æ•°æ®å¯¹æ¯”** â­
- åˆ›å»ºäº†Tç‰©å€™ç‰ˆæœ¬çš„å®Œæ•´åˆ†ææµç¨‹
- å¯ä»¥å¯¹æ¯”GPPç‰©å€™ vs Tç‰©å€™çš„å·®å¼‚
- ä¿æŒäº†ä»£ç ç»“æ„çš„ä¸€è‡´æ€§

### 3. **åˆ†ææ‰©å±•**
- åœ¨åŸå§‹åˆ†è§£æ–¹æ³•ä¸­æ·»åŠ äº†Trateï¼ˆæ—¥å‡è’¸è…¾é€Ÿç‡ï¼‰åˆ†æ
- å¯ä»¥ç ”ç©¶è’¸è…¾é€Ÿç‡ä¸ç‰©å€™çš„å…³ç³»

### 4. **ä»£ç ä¼˜åŒ–**
- å®Œå–„äº†NODATAå¤„ç†
- ç»Ÿä¸€äº†å‡½æ•°æ¥å£
- æ”¹è¿›äº†ä»£ç æ³¨é‡Š

---

## âœ… å½“å‰è¿›åº¦

### å·²å®Œæˆ âœ…
1. âœ… TRcè®¡ç®—ï¼ˆGPP + Tç‰©å€™åŒç‰ˆæœ¬ï¼‰
2. âœ… åŸå§‹åˆ†è§£ï¼ˆGPP + Tç‰©å€™åŒç‰ˆæœ¬ï¼‰
3. âœ… Timing/Shapeåˆ†è§£ï¼ˆGPPç‰©å€™ï¼‰
4. âœ… ç»Ÿè®¡åˆ†æï¼ˆåŸå§‹åˆ†è§£ + Timing/Shapeï¼‰
5. âœ… Trateåˆ†æï¼ˆæ—¥å‡è’¸è…¾é€Ÿç‡ï¼‰
6. âœ… Î”SOSç¬¦å·ä¿®æ­£ï¼ˆæ ‡å‡†å¼‚å¸¸å®šä¹‰ï¼‰

### å¾…å®Œæˆ â³
1. â³ Timing/Shapeåˆ†è§£çš„Tç‰©å€™ç‰ˆæœ¬
2. â³ æ”¹è¿›åˆ†è§£æ–¹æ³•ï¼ˆ04_decomposition_improved.pyï¼‰çš„å®Œå–„
3. â³ Section 3.3 é©±åŠ¨å› å­åˆ†æçš„å®ç°
4. â³ SEMç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆ06_SEM_analysis.Rï¼‰
5. â³ å¯è§†åŒ–ç»˜å›¾ï¼ˆ07_plotting_functions.pyï¼‰
6. â³ ç»“æœä¸Wang 2025è®ºæ–‡çš„å¯¹æ¯”éªŒè¯

---

## ğŸ“ å»ºè®®åç»­å·¥ä½œ

### ä¼˜å…ˆçº§1: éªŒè¯æ–°æ–¹æ³•
```bash
# è¿è¡ŒTiming/Shapeåˆ†è§£å’Œç»Ÿè®¡åˆ†æ
python 03_decomposition_timing_shape.py
python 05_statistical_analysis_timing_shape.py

# å¯¹æ¯”ä¸‰ç§åˆ†è§£æ–¹æ³•çš„ç»“æœ
# - åŸå§‹æ–¹æ³• (TRpheno, TRproduct)
# - Timing/Shape (TRtiming, TRshape, TRsos, TRpos)
```

### ä¼˜å…ˆçº§2: å®Œå–„Tç‰©å€™åˆ†æ
```bash
# åˆ›å»ºTiming/Shapeçš„Tç‰©å€™ç‰ˆæœ¬
cp 03_decomposition_timing_shape.py 03_decomposition_timing_shape_T.py
cp 05_statistical_analysis_timing_shape.py 05_statistical_analysis_timing_shape_T.py

# ä¿®æ”¹ç‰©å€™æºå’Œè¾“å‡ºè·¯å¾„ï¼ˆå‚è€ƒ*_T.pyæ–‡ä»¶çš„ä¿®æ”¹æ¨¡å¼ï¼‰
```

### ä¼˜å…ˆçº§3: æ•´ç†åˆ†ææŠ¥å‘Š
- åˆ›å»ºç»“æœå¯¹æ¯”æ–‡æ¡£ï¼ˆä¸‰ç§åˆ†è§£æ–¹æ³• Ã— ä¸¤ç§ç‰©å€™ï¼‰
- åˆ†æå„æ–¹æ³•çš„ä¼˜ç¼ºç‚¹
- ä¸Wang 2025è®ºæ–‡ç»“æœå¯¹æ¯”

---

## ğŸ”§ æŠ€æœ¯è¦ç‚¹è®°å½•

### 1. Î”SOSæ ‡å‡†å®šä¹‰
```python
# âœ… æ­£ç¡®ï¼ˆæ ‡å‡†å¼‚å¸¸å®šä¹‰ï¼‰
Î”SOS = SOS_year - SOSav
# æå‰æ—¶: SOS_year < SOSav â†’ Î”SOS < 0
# æ¨è¿Ÿæ—¶: SOS_year > SOSav â†’ Î”SOS > 0
```

### 2. Trateè®¡ç®—
```python
# GLS = ç”Ÿé•¿å­£é•¿åº¦ (Growing Season Length)
GLS = POS - SOS + 1  # å¤©æ•°

# Trate = æ—¥å‡è’¸è…¾é€Ÿç‡
Trate = TRc / GLS  # mm/day
```

### 3. Timing/Shapeåˆ†è§£æ ¸å¿ƒ
```python
# A(t): æ°”å€™æ€æ—¥TR
# B_y(t): å½“å¹´æ—¥TR
# [SOSav, POSav]: æ°”å€™æ€çª—å£
# [SOS_y, POS_y]: å½“å¹´çª—å£

TRc_av = Î£[t=SOSav..POSav] A(t)
TRc_y  = Î£[t=SOS_y..POS_y] B_y(t)

Î”TR_timing = Î£[t=SOS_y..POS_y] A(t) - TRc_av  # çª—å£å˜åŒ–
Î”TR_shape  = Î£[t=SOS_y..POS_y] (B_y(t) - A(t))  # å¼ºåº¦å˜åŒ–
```

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-12-24 13:50
**ç‰ˆæœ¬**: v1.0
**ä½œè€…**: Claude Code Analysis
